<!DOCTYPE html>
<html>

<head>
    <title>template</title>
    <meta http-equiv="Content-type" content="text/html;charset=utf-8" />
    <meta name="Description" content="Learning Rust Wasm/Webassembly programming and having fun">
    <meta name="author" content="https://github.com/bestia-dev">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/bestia01.css">
    <script>
        /* Toggle between adding and removing the "responsive" class to navbar when the user clicks on the hamburger */
        function toggle_responsive_navbar() {
            var x = document.getElementById("navbar");
            if (x.className.includes(" responsive")) {
                x.className = x.className.replace(" responsive", "");
            } else {
                x.className += " responsive";
            }
        }
    </script>
</head>

<body>
    <div class="fixed_header">
        <div id="navbar">
            <a id="navbar_brand" href="https://bestia.dev">
                <img src="bestia_icon.png" alt="Bestia development" title="bestia.dev" />
                <span id="navbar_title"> Bestia dev</span>
            </a>
            <a id="navbar_hamburger" href="javascript:void(0);" onclick="toggle_responsive_navbar()">â˜° </a>
            <div id="navbar_topics">
                <a href="/index.html#home" onclick="toggle_responsive_navbar()">Home </a>
                <a href="/index.html#tutorials" onclick="toggle_responsive_navbar()">Tutorials</a>
                <a href="/index.html#games" onclick="toggle_responsive_navbar()">Games</a>
                <a href="/index.html#productivity" onclick="toggle_responsive_navbar()">Productivity</a>
                <a href="/index.html#contact" onclick="toggle_responsive_navbar()">Contact</a>
            </div>
        </div>
    </div>

<article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-dropbox_backup_to_external_disk" class="anchor" aria-hidden="true" href="#dropbox_backup_to_external_disk"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>dropbox_backup_to_external_disk</h1>
<p dir="auto"><strong>One way sync from dropbox to external disc</strong><br>
<em><strong>version: 2022.523.1658 date: 2022-05-23 author: <a href="https://bestia.dev" rel="nofollow">bestia.dev</a> repository: <a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/">Github</a></strong></em></p>
<p dir="auto"><a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/"><img src="https://camo.githubusercontent.com/7470b74c12dc300d98de738c6d18ef351f565edd1de1f647d74abe197a791fb8/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c696e65735f696e5f527573742d313735382d677265656e2e737667" alt="Lines in Rust code" data-canonical-src="https://img.shields.io/badge/Lines_in_Rust-1758-green.svg" style="max-width: 100%;"></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/"><img src="https://camo.githubusercontent.com/49dcaba2386492a3cf14d6ac33aee26b9d03f804414852d62df25c8ea2f7e74d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c696e65735f696e5f446f635f636f6d6d656e74732d3239312d626c75652e737667" alt="Lines in Doc comments" data-canonical-src="https://img.shields.io/badge/Lines_in_Doc_comments-291-blue.svg" style="max-width: 100%;"></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/"><img src="https://camo.githubusercontent.com/a42a00960f64e2664236dc500fe0e6f24beedcf6bb375c93592d2e1142fc8897/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c696e65735f696e5f636f6d6d656e74732d3136312d707572706c652e737667" alt="Lines in Comments" data-canonical-src="https://img.shields.io/badge/Lines_in_comments-161-purple.svg" style="max-width: 100%;"></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/"><img src="https://camo.githubusercontent.com/ca23628eb99142a21cb1c4d2691f8eb74e53f9731e50ebd3dab96f4ea3baa96b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c696e65735f696e5f6578616d706c65732d302d79656c6c6f772e737667" alt="Lines in examples" data-canonical-src="https://img.shields.io/badge/Lines_in_examples-0-yellow.svg" style="max-width: 100%;"></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/"><img src="https://camo.githubusercontent.com/1b1b893bf6a344f5b57d01d3bd940441cb82ea48c2fc81a76d87bfcf5a5cf50e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c696e65735f696e5f74657374732d302d6f72616e67652e737667" alt="Lines in tests" data-canonical-src="https://img.shields.io/badge/Lines_in_tests-0-orange.svg" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/blob/main/LICENSE"><img src="https://camo.githubusercontent.com/83d3746e5881c1867665223424263d8e604df233d0a11aae0813e0414d433943/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c75652e737667" alt="License" data-canonical-src="https://img.shields.io/badge/license-MIT-blue.svg" style="max-width: 100%;"></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/workflows/RustAction/badge.svg" alt="Rust" style="max-width: 100%;"></a>
<a href="https://hits.seeyoufarm.com" rel="nofollow"><img src="https://camo.githubusercontent.com/bbca48f05d12622bd5f497f096eb4b5f2451482e84cdcaee65669b4a6b235647/68747470733a2f2f686974732e736565796f756661726d2e636f6d2f6170692f636f756e742f696e63722f62616467652e7376673f75726c3d68747470732533412532462532466769746875622e636f6d2532466265737469612d64657625324664726f70626f785f6261636b75705f746f5f65787465726e616c5f6469736b26636f756e745f62673d253233373943383344267469746c655f62673d2532333535353535352669636f6e3d2669636f6e5f636f6c6f723d253233453745374537267469746c653d6869747326656467655f666c61743d66616c7365" alt="Hits" data-canonical-src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2Fbestia-dev%2Fdropbox_backup_to_external_disk&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=hits&amp;edge_flat=false" style="max-width: 100%;"></a></p>
<p dir="auto">Hashtags: #rustlang #tutorial #dropbox #cli</p>
<h2 dir="auto"><a id="user-content-motivation" class="anchor" aria-hidden="true" href="#motivation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Motivation</h2>
<p dir="auto">On my Dropbox "remote drive" I have more than 1 Terabyte of data in 200 000 files.<br>
I own now 4 notebooks and 2 android phones and 1 tablet and not a single one has an internal drive with more than 1 Terabyte. I use dropbox <code>Selective Sync</code> to sync only the bare minimum I temporarily need on the local device. But I want to have a backup of all of my data. I must have a backup. Better, I want to have 2 backups of all the data on 2 external hard disks in different locations. So if Dropbox go bankrupt, I still have all my data.<br>
The original Dropbox Sync app works great for the internal HD, but is "not recommended" for external drives. I also need only one way sync: from remote to local. There exist apps for that:</p>
<ul dir="auto">
<li>rclone</li>
<li>dropbox_uploader</li>
</ul>
<p dir="auto">But I wanted to write something mine for fun, learning Rust and using my own apps.
I have a lot of files, so I wanted to list them first - remote and local. Then compare the lists and finally download the files.<br>
Obsolete files will "move to trash folder", so I can inspect what and how to delete manually.<br>
The dropbox remote storage will always be read_only, nothing will be modified there, never, no permission for that.</p>
<h2 dir="auto"><a id="user-content-try-it" class="anchor" aria-hidden="true" href="#try-it"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Try it</h2>
<p dir="auto">There are a few manual steps for the security of you files on Dropbox. Authentication on internet is a complex topic.<br>
You should be logged in Linux terminal (also in WSL2) with your account. So things you do, are not visible to others. You will set some local environment variables that are private/secret to your linux Session.  After you logout from you Linux session these local environment variables will be deleted.<br>
The executable will create a sub-directory <code>temp_data</code> in the current directory. Maybe it is best if you create a dedicated directory <code>~/dropbox_backup_to_external_disk/</code> just for this executable.
Download the latest release from <a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/releases">Github</a> and make the file executable and enable auto-completion:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="cd ~
mkdir dropbox_backup_to_external_disk
cd dropbox_backup_to_external_disk

curl -L https://github.com/bestia-dev/dropbox_backup_to_external_disk/releases/latest/download/dropbox_backup_to_external_disk --output dropbox_backup_to_external_disk

chmod +x dropbox_backup_to_external_disk
alias dropbox_backup_to_external_disk=./dropbox_backup_to_external_disk
complete -C &quot;dropbox_backup_to_external_disk completion&quot; dropbox_backup_to_external_disk
dropbox_backup_to_external_disk --help"><pre><span class="pl-c1">cd</span> <span class="pl-k">~</span>
mkdir dropbox_backup_to_external_disk
<span class="pl-c1">cd</span> dropbox_backup_to_external_disk

curl -L https://github.com/bestia-dev/dropbox_backup_to_external_disk/releases/latest/download/dropbox_backup_to_external_disk --output dropbox_backup_to_external_disk

chmod +x dropbox_backup_to_external_disk
<span class="pl-c1">alias</span> dropbox_backup_to_external_disk=./dropbox_backup_to_external_disk
<span class="pl-c1">complete</span> -C <span class="pl-s"><span class="pl-pds">"</span>dropbox_backup_to_external_disk completion<span class="pl-pds">"</span></span> dropbox_backup_to_external_disk
dropbox_backup_to_external_disk --help</pre></div>
<p dir="auto">Run the executable with --help and follow carefully the instructions 1. and 2.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/screenshot_1.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/screenshot_1.png" alt="screenshot_1" title="screenshot_1" style="max-width: 100%;"></a> <a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/screenshot_2.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/screenshot_2.png" alt="screenshot_2" title="screenshot_2" style="max-width: 100%;"></a> <a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/list_2.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/list_2.png" alt="list_2" title="list_2" style="max-width: 100%;"></a> <a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/list_3.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/list_3.png" alt="list_3" title="list_3" style="max-width: 100%;"></a> <a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/list_4.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/list_4.png" alt="list_4" title="list_4" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-warning" class="anchor" aria-hidden="true" href="#warning"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Warning</h2>
<p dir="auto">I don't know why, but WSL2 sometimes does not see all the folders of the external disk.<br>
Instead of 12.000 folders it sees only 28 ???<br>
Be careful !<br>
I then restart my Win10 and the problem magically disappears.</p>
<h2 dir="auto"><a id="user-content-second-backup" class="anchor" aria-hidden="true" href="#second-backup"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Second backup</h2>
<p dir="auto">It is wise to have 2 backups on external disks and store them in separate locations. Just to be sure.<br>
If you have internet access on both places then you can sync backup_2 just the same way you sync backup_1.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/workflow_2.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/workflow_2.png" alt="workflow_2" title="workflow_2" style="max-width: 100%;"></a></p>
<p dir="auto">But sometimes your backup_1 is already in sync. And if both external disks are in the same place, it is faster to just one-way sync from backup_1 to backup_2 with</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="dropbox_backup_to_external_disk second_backup /mnt/f/DropBoxBackup2"><pre>dropbox_backup_to_external_disk second_backup /mnt/f/DropBoxBackup2</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/workflow_1.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/workflow_1.png" alt="workflow_1" title="workflow_1" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-remove-empty-folders" class="anchor" aria-hidden="true" href="#remove-empty-folders"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>remove empty folders</h2>
<p dir="auto">In powershell if you give the same folder twice like this:<br>
<code>robocopy "f:\DropBoxBackup2" "f:\DropBoxBackup2" /S /move</code><br>
it will remove empty folders.<br>
Warning: the folders must be identical !</p>
<h2 dir="auto"><a id="user-content-development" class="anchor" aria-hidden="true" href="#development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Development</h2>
<p dir="auto">I use <a href="https://crates.io/crates/cargo-auto" rel="nofollow">cargo-auto</a> for automation tasks in rust language. Install it:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="cargo install cargo-auto"><pre>cargo install cargo-auto</pre></div>
<p dir="auto">List user-defined automation tasks in <code>automation_tasks_rs</code>:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="cargo auto"><pre>cargo auto</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/cargo_auto_1.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/cargo_auto_1.png" alt="cargo_auto_1" title="cargo_auto_1" style="max-width: 100%;"></a></p>
<p dir="auto">I use WSL2 (Debian) on Win10 to develope and execute this CLI in Debian Linux.<br>
The external disk path from WSL2 looks like this: <code>/mnt/d/DropBoxBackup1</code>.  Or for the second backup on my system <code>/mnt/f/DropBoxBackup2</code>.<br>
The CLI saves the list of the local files metadata in <code>temp_data/list_local_files.csv</code>.<br>
And the list of the files metadata from the remote Dropbox to in <code>temp_data/list_remote_files.csv</code>.
Tab delimited with metadata: path (with name), datetime modified, size.
The remote path is not really case-sensitive. They try to make it case-preserve, but this apply only to the last part of the path. Before that it is random-case.
For big dropbox remotes it can take a while to complete. After the first level folders are listed, I use 3 threads in a ThreadPool to get sub-folders recursively in parallel. It makes it much faster. Also the download of files is in parallel on multiple threads.<br>
The sorting of lists is also done in parallel with the crate Rayon.<br>
Once the lists are complete the CLI will compare them and create files:<br>
<code>list_for_correct_time.csv</code><br>
<code>list_for_download.csv</code><br>
<code>list_for_trash.csv</code><br>
With this files the CLI will:<br>
<code>move_or_rename_local_files</code> if (name, size and file date) are equal, or (size, date and content_hash)
<code>trash_from_list</code> will move the obsolete files into a trash folder<br>
<code>correct_time_from_list</code> sometimes it is needed<br>
<code>download_from_list</code> - this can take a lot of time and it can be stopped with ctrl+c</p>
<h2 dir="auto"><a id="user-content-dropbox-api2---stone-sdk" class="anchor" aria-hidden="true" href="#dropbox-api2---stone-sdk"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>DropBox api2 - Stone sdk</h2>
<p dir="auto">Dropbox has made a <code>Stone</code> thingy that contains all the API definition. From there is possible to generate code boilerplate for different languages for the api-client.<br>
For Rust there is this quasi official project:<br>
<a href="https://crates.io/crates/dropbox-sdk" rel="nofollow">https://crates.io/crates/dropbox-sdk</a></p>
<h2 dir="auto"><a id="user-content-authorization-oauth2" class="anchor" aria-hidden="true" href="#authorization-oauth2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Authorization OAuth2</h2>
<p dir="auto">Authorization on the internet is a mess. Dropbox api uses OAuth2.
Every app must be authorized on Dropbox and have its own <code>app key</code> and <code>app secret</code>.<br>
For commercial programs they probably embed them into the binary code somehow. But for OpenSource projects it is not possible to keep a secret. So the workaround is: every user must create a new <code>dropbox app</code> exclusive only to him. Creating a new app is simple. This app will stay forever in <code>development status</code> in dropbox, to be more private and secure. The<br>
<code>$ dropbox_backup_to_external_disk --help</code><br>
has the detailed instructions.<br>
Then every time before use we need generate the "short-lived access token" for security reasons. There is the possibility to choose "no expiration" token, but I don't like it. Dropbox backup is used rarely and it is not super frustrating to make few clicks for security of your precious files. Having a "no expiration" token is like having another password for the hackers to try to hack. I like more the "short-lived" token. When I'm not using this backup program, there is no access token at all.<br>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/dropbox_2.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/dropbox_2.png" alt="dropbox_2" title="dropbox_2" style="max-width: 100%;"></a> <a target="_blank" rel="noopener noreferrer" href="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/dropbox_1.png"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk/raw/main/images/dropbox_1.png" alt="dropbox_1" title="dropbox_1" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-rename-or-move" class="anchor" aria-hidden="true" href="#rename-or-move"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>rename or move</h2>
<p dir="auto">Often a file is renamed or moved to another folder.<br>
I can try to recognize if there is the same file in list_for_trash and list_for download.<br>
If the name, size and file date are equal then they are probably the same file.<br>
If the name is different, then try if content_hash is equal, but that is slow.</p>
<h2 dir="auto"><a id="user-content-bash-auto-completion" class="anchor" aria-hidden="true" href="#bash-auto-completion"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>bash auto-completion</h2>
<p dir="auto">This executable is prepared for auto-completion in bash.<br>
Run this command to define auto-completion in bash for the current session:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="alias dropbox_backup_to_external_disk=./dropbox_backup_to_external_disk
complete -C &quot;dropbox_backup_to_external_disk completion&quot; dropbox_backup_to_external_disk"><pre><span class="pl-c1">alias</span> dropbox_backup_to_external_disk=./dropbox_backup_to_external_disk
<span class="pl-c1">complete</span> -C <span class="pl-s"><span class="pl-pds">"</span>dropbox_backup_to_external_disk completion<span class="pl-pds">"</span></span> dropbox_backup_to_external_disk</pre></div>
<p dir="auto">To make it permanent add this command to the file <code>~/.bashrc</code> or some other file that runs commands on bash initialization.</p>
<h2 dir="auto"><a id="user-content-learn-something-new-every-day" class="anchor" aria-hidden="true" href="#learn-something-new-every-day"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Learn something new every day</h2>
<h3 dir="auto"><a id="user-content-regex-adventure-with-non-breaking-space-and-crlf" class="anchor" aria-hidden="true" href="#regex-adventure-with-non-breaking-space-and-crlf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>REGEX adventure with non-breaking space and CRLF</h3>
<p dir="auto">We all know space. But there are other non-visible characters that are very similar and sometimes impossible to distinguish. Tab is one of them, but it is not so difficult to spot with a quick try.<br>
But nbsp non-breaking space, often used in HTML is a catastrophe. There is no way to tell it apart from the normal space. I used a regex to find a match with some spaces. It worked right for a years. Yesterday it didn't work. If I changed space to <code>\s</code> in the regex expression, it worked, but not with space. I tried everything and didn't find the cause. Finally I deleted and inserted the space. It works. But how? After a detailed analysis I discovered it was a non-breakable space. This is unicode 160 or \xa0, instead of normal space unicode 32 \x20. Now I will try to find them all and replace with normal space. What a crazy world.<br>
And another REGEX surprise. I try to have all text files delimited with the unix standard LF. But somehow the windows standard got mixed and I didn't recognize it. The regex for <code>end of line</code> $ didn't work for CRLF. When I changed it to LF, the good life is back and all works.</p>
<h3 dir="auto"><a id="user-content-text-files" class="anchor" aria-hidden="true" href="#text-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Text files</h3>
<p dir="auto">Simple text files are a terrible way to store data that needs to be changed. It is ok for write once and then read. But there is not a good way to modify only one line inside a big text file. The recommended approach is read all, modify, save all. If the memory is not big enough then use a buffer to read a segment, modify, save a segment, repeat to end.<br>
There is another approach called memory map to file, but everybody is trying to avoid it because some other process could modify the file when in use and make it garbage.<br>
Sounds like a database is always a better choice for more agile development.<br>
In this project I will create additional files that only append lines. Some kind of journal. And later use this to modify the big text files in one go. For example: list_just_downloaded_or_moved.csv is added to list_local_files.csv.</p>
<h3 dir="auto"><a id="user-content-termion" class="anchor" aria-hidden="true" href="#termion"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>termion</h3>
<p dir="auto">After using some small crates to help me with Linux tty terminal ansi codes, I am happy to finally use only the <code>termion</code> crate.<br>
It has all I need.</p>
<h3 dir="auto"><a id="user-content-how-to-invert-black-white-in-paintnet-for-dark-theme" class="anchor" aria-hidden="true" href="#how-to-invert-black-white-in-paintnet-for-dark-theme"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>how to invert black-white in paint.net for dark theme</h3>
<p dir="auto">This is not same as <code>invert color</code>.<br>
Invert only black and white is for image transformation to <code>dark theme</code>.</p>
<ol dir="auto">
<li>Open image in PdN.</li>
<li>Duplicate layer.</li>
<li>Convert bottom layer to B/W.</li>
<li>Invert Colors bottom layer.</li>
<li>Adjust Contrast to 0 on top layer.</li>
<li>Change top layer blending mode to overlay.</li>
</ol>
<h2 dir="auto"><a id="user-content-todo" class="anchor" aria-hidden="true" href="#todo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TODO</h2>
<p dir="auto">Can I recognize that a directory is moved or renamed? This is common and should be super fast.<br>
If most of the files in the directory are equal it means, that it is moved/renamed.<br>
Then a new <code>compare_lists</code> will generate a new list if there are smaller differences.</p>
<h2 dir="auto"><a id="user-content-cargo-crev-reviews-and-advisory" class="anchor" aria-hidden="true" href="#cargo-crev-reviews-and-advisory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>cargo crev reviews and advisory</h2>
<p dir="auto">We leave in times of danger with <a href="https://en.wikipedia.org/wiki/Supply_chain_attack" rel="nofollow">supply chain attacks</a>.<br>
It is recommended to always use <a href="https://github.com/crev-dev/cargo-crev">cargo-crev</a><br>
to verify the trustworthiness of each of your dependencies.<br>
Please, spread this info.<br>
You can also read reviews quickly on the web. Example for the crate <code>num-traits</code>:<br>
<a href="https://web.crev.dev/rust-reviews/crate/num-traits/" rel="nofollow">https://web.crev.dev/rust-reviews/crate/num-traits/</a></p>
<h2 dir="auto"><a id="user-content-open-source-free-and-free-as-a-beer" class="anchor" aria-hidden="true" href="#open-source-free-and-free-as-a-beer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>open-source free and free as a beer</h2>
<p dir="auto">My open-source projects are free and free as a beer (MIT license).<br>
I just love programming.<br>
But I need also to drink. If you find my projects and tutorials helpful,<br>
please buy me a beer or two donating on my <a href="https://paypal.me/LucianoBestia" rel="nofollow">paypal</a>.<br>
You know the price of a beer in your local bar ;-)<br>
So I can drink a free beer for your health :-)<br>
<a href="https://translate.google.com/?hl=en&amp;sl=sl&amp;tl=en&amp;text=Na%20zdravje&amp;op=translate" rel="nofollow">Na zdravje</a> !</p>
</article>
</body>

</html>